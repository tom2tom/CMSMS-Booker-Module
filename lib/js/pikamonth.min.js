/*!
 * Pikamonth - derived from Pikaday
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/dbushell/Pikamonth
 */
(function(a,b){"use strict";var d;if(typeof exports==="object"){try{d=require("moment")}catch(c){}module.exports=b(d)}else{if(typeof define==="function"&&define.amd){define(function(f){var h="moment";try{d=f(h)}catch(g){}return b(d)})}else{a.Pikamonth=b(a.moment)}}}(this,function(w){"use strict";var g=typeof w==="function",d=!!window.addEventListener,n=window.document,s=window.setTimeout,p=function(A,B,C,z){if(d){A.addEventListener(B,C,!!z)}else{A.attachEvent("on"+B,C)}},t=function(A,B,C,z){if(d){A.removeEventListener(B,C,!!z)}else{A.detachEvent("on"+B,C)}},y=function(A,z,B){var C;if(n.createEvent){C=n.createEvent("HTMLEvents");C.initEvent(z,true,false);C=v(C,B);A.dispatchEvent(C)}else{if(n.createEventObject){C=n.createEventObject();C=v(C,B);A.fireEvent("on"+z,C)}}},u=function(z){return z.trim?z.trim():z.replace(/^\s+|\s+$/g,"")},b=function(z,A){return(" "+z.className+" ").indexOf(" "+A+" ")!==-1},i=function(z,A){if(!b(z,A)){z.className=(z.className==="")?A:z.className+" "+A}},k=function(z,A){z.className=u((" "+z.className+" ").replace(" "+A+" "," "))},o=function(C){var B=getComputedStyle(C);if(B.display==="none"){return false}if(B.visibility!=="visible"){return false}if(B.opacity<0.1){return false}var D=C.getBoundingClientRect();if(C.offsetWidth+C.offsetHeight+D.height+D.width===0){return false}var z=D.left+C.offsetWidth/2;if(z<0){return false}if(z>(n.documentElement.clientWidth||window.innerWidth)){return false}var E=D.top+C.offsetHeight/2;if(E<0){return false}if(E>(n.documentElement.clientHeight||window.innerHeight)){return false}var A=n.elementFromPoint(z,E);do{if(A===C){return true}}while(A=A.parentNode);return false},h=function(z){return(/Array/).test(Object.prototype.toString.call(z))},x=function(z){return(/Date/).test(Object.prototype.toString.call(z))&&!isNaN(z.getTime())},j=function(A){if(x(A)){var B=A.getFullYear(),z=A.getMonth();A.setFullYear(B,z)}},q=function(A,z){return A.getTime()===z.getTime()},v=function(D,C,z){var B,A;for(B in C){A=D[B]!==undefined;if(A&&typeof C[B]==="object"&&C[B]!==null&&C[B].nodeName===undefined){if(x(C[B])){if(z){D[B]=new Date(C[B].getTime())}}else{if(h(C[B])){if(z){D[B]=C[B].slice(0)}}else{D[B]=v({},C[B],z)}}}else{if(z||!A){D[B]=C[B]}}}return D},a=function(A,z){var B=w(A,z);return(B&&B.isValid())?B.toDate():null},f=function(A,z){return w(A).format(z)},defaults={field:null,bound:undefined,position:"bottom left",reposition:true,format:"YYYY-MM",abbr:true,defaultDate:null,setDefaultDate:false,minDate:null,maxDate:null,yearRange:10,minYear:0,maxYear:9999,isRTL:false,yearSuffix:"",container:undefined,i18n:{previousYear:"Previous Year",nextYear:"Next Year",months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},getdate:null,reformat:null,onSelect:null,onOpen:null,onClose:null,onDraw:null},m=function(z,D,F,C,B,G){var E=[],H,A;if(G){E.push("is-disabled")}if(B){E.push("is-today")}if(C){E.push("is-selected")}H=(E.length>0)?' class="'+E.join(" ")+'"':"";A=z.abbr?z.i18n.monthsShort[D]:z.i18n.months[D];return'<td data-month="'+D+'"'+H+'><button class="pika-button pika-text" data-pika-year="'+F+'" data-pika-month="'+D+'" data-pika-day="1">'+A+"</button></td>"},e=function(A,z){return"<tr>"+(z?A.reverse():A).join("")+"</tr>"},c=function(z){return"<tbody>"+z.join("")+"</tbody>"},r=function(H,G){var C,B,F,D,z=H._o,A=G===z.minYear,I=G===z.maxYear,E='<div class="pika-title">';D=z.i18n.previousYear;E+='<button class="pika-prev'+(A?" is-disabled":"")+'" type="button" title="'+D+'">'+D+"</button>";if(h(z.yearRange)){C=z.yearRange[0];B=z.yearRange[1]+1}else{C=G-z.yearRange;B=1+G+z.yearRange}for(F=[];C<B&&C<=z.maxYear;C++){if(C>=z.minYear){F.push('<option value="'+C+'"'+(C===G?" selected":"")+">"+(C)+"</option>")}}E+='<div class="pika-label"><select class="pika-select pika-select-year">'+F.join("")+"</select></div>";D=z.i18n.nextYear;E+='<button class="pika-next'+(I?" is-disabled":"")+'" type="button" title="'+D+'">'+D+"</button>";return E+"</div>"},l=function(z,A){return'<table class="pika-table">'+c(A)+"</table>"},Pikamonth=function(B){var z=this,C=z.config(B);z._onMouseDown=function(E){if(!z._v){return}E=E||window.event;var D=E.target||E.srcElement;if(!D){return}if(!b(D,"is-disabled")){if(b(D,"pika-button")&&!b(D,"is-empty")){z.setDate(new Date(D.getAttribute("data-pika-year"),D.getAttribute("data-pika-month"),D.getAttribute("data-pika-day")),false);if(C.bound){s(function(){z.hide();if(C.field){C.field.blur()}},100)}return}else{if(b(D,"pika-prev")){z.prevYear()}else{if(b(D,"pika-next")){z.nextYear()}}}}if(!b(D,"pika-select")){if(E.preventDefault){E.preventDefault()}else{E.returnValue=false;return false}}else{z._c=true}};z._onChange=function(E){E=E||window.event;var D=E.target||E.srcElement;if(!D){return}if(b(D,"pika-select-year")){z.gotoYear(D.value)}};z._onInputChange=function(E){var D;if(E.firedBy===z){return}if(typeof C.getdate==="function"){D=C.getdate.call(this,C.field.value,C.format)}else{D=new Date(Date.parse(C.field.value))}z.setDate(x(D)?D:null);if(!z._v){z.show()}};z._onInputFocus=function(){z.show()};z._onInputClick=function(){z.show()};z._onInputBlur=function(){var D=n.activeElement;do{if(b(D,"pika-single")){return}}while((D=D.parentNode));if(!z._c){z._b=s(function(){z.hide()},50)}z._c=false};z._onClick=function(E){E=E||window.event;var D=E.target||E.srcElement,F=D;if(!D){return}if(!d&&b(D,"pika-select")){if(!D.onchange){D.setAttribute("onchange","return;");p(D,"change",z._onChange)}}do{if(b(F,"pika-single")||F===C.trigger){return}}while((F=F.parentNode));if(z._v&&D!==C.trigger&&F!==C.trigger){z.hide()}};z.el=n.createElement("div");z.el.className="pika-single"+(C.isRTL?" is-rtl":"");p(z.el,"mousedown",z._onMouseDown,true);p(z.el,"change",z._onChange);if(C.field){if(C.container){C.container.appendChild(z.el)}else{if(C.bound){n.body.appendChild(z.el)}else{C.field.parentNode.insertBefore(z.el,C.field.nextSibling)}}p(C.field,"change",z._onInputChange);if(!C.defaultDate&&C.field.value){if(typeof C.getdate==="function"){C.defaultDate=C.getdate.call(this,C.field.value,C.format)}else{C.defaultDate=new Date(Date.parse(C.field.value))}C.setDefaultDate=C.defaultDate==true}}var A=C.defaultDate;if(x(A)){if(C.setDefaultDate){z.setDate(A,true)}else{z.gotoDate(A)}}else{z.gotoDate(new Date())}if(C.bound){this.hide();z.el.className+=" is-bound";p(C.trigger,"click",z._onInputClick);p(C.trigger,"focus",z._onInputFocus);p(C.trigger,"blur",z._onInputBlur)}else{this.show()}};Pikamonth.prototype={config:function(B){if(!this._o){this._o=v({},defaults,true)}var A=v(this._o.i18n,B.i18n,true),C=v(this._o,B,true);C.i18n=A;C.isRTL=!!C.isRTL;C.field=(C.field&&C.field.nodeName)?C.field:null;C.bound=!!(C.bound!==undefined?C.field&&C.bound:C.field);C.trigger=(C.trigger&&C.trigger.nodeName)?C.trigger:C.field;C.disableMonthFn=(typeof C.disableMonthFn)=="function"?C.disableMonthFn:null;var z=parseInt(C.numberOfYears,10)||1;C.numberOfYears=z>5?5:z;if(!x(C.minDate)){C.minDate=false}if(!x(C.maxDate)){C.maxDate=false}if((C.minDate&&C.maxDate)&&C.maxDate<C.minDate){C.maxDate=C.minDate=false}if(C.minDate){j(C.minDate);C.minYear=C.minDate.getFullYear()}if(C.maxDate){j(C.maxDate);C.maxYear=C.maxDate.getFullYear()}if(h(C.yearRange)){var D=new Date().getFullYear()-10;C.yearRange[0]=parseInt(C.yearRange[0],10)||D;C.yearRange[1]=parseInt(C.yearRange[1],10)||D}else{C.yearRange=Math.abs(parseInt(C.yearRange,10))||defaults.yearRange;if(C.yearRange>100){C.yearRange=100}}if(!C.getdate&&g){C.getdate=a}if(!C.reformat&&g){C.reformat=f}return C},toString:function(z){if(this._d&&x(this._d)){if(typeof this._o.reformat==="function"){return this._o.reformat.call(this,this._d,z||this._o.format)}else{return this._d.toDateString()}}return""},getMoment:function(){return null},setMoment:function(z,A){},getDate:function(){return x(this._d)?new Date(this._d.getTime()):null},setDate:function(B,G){if(!B){this._d=null;if(this._o.field){this._o.field.value="";if(this._o.field!=this._o.trigger){y(this._o.field,"change",{firedBy:this})}}this.draw();return}if(typeof B==="string"){B=new Date(Date.parse(B))}if(!x(B)){return}var E=this._o.minDate,H=this._o.maxDate;if(x(E)&&B<E){B=E}else{if(x(H)&&B>H){B=H}}var C=new Date(B.getTime());j(C);this.gotoDate(C);var A=this._o.field.value;if(A){var z;if(typeof this._o.getdate==="function"){z=this._o.getdate.call(this,A,this._o.format)}else{z=new Date(Date.parse(A))}if(x(z)){var D=z.getTime();j(z);var F=D-z.getTime();if(F){C.setTime(C.getTime()+F)}}}this._d=C;this._o.field.value=this.toString();if(this._o.field!=this._o.trigger){y(this._o.field,"change",{firedBy:this})}if(!G&&typeof this._o.onSelect==="function"){this._o.onSelect.call(this,this.getDate())}},gotoDate:function(z){if(!x(z)){return}this._year=z.getFullYear();this.draw()},gotoToday:function(){this.gotoDate(new Date())},gotoYear:function(z){var A=parseInt(z,10);if(!isNaN(A)){this._year=A;this.draw()}},nextYear:function(){if(!isNaN(this._year)){this._year++;this.draw()}},prevYear:function(){if(!isNaN(this._year)){this._year--;this.draw()}},setMinDate:function(z){this._o.minDate=z},setMaxDate:function(z){this._o.maxDate=z},draw:function(D){if(!this._v&&!D){return}var C=this._o,E=C.minYear,z=C.maxYear,B;if(!isNaN(E)&&this._y<=E){this._y=E}if(!isNaN(z)&&this._y>=z){this._y=z}B='<div class="pika-pikker">'+r(this,this._year)+this.render(this._year)+"</div>";this.el.innerHTML=B;if(C.bound){if(C.field.type!=="hidden"){s(function(){C.trigger.focus()},1)}}if(typeof this._o.onDraw==="function"){var A=this;s(function(){A._o.onDraw.call(A)},0)}},adjustPosition:function(){if(this._o.container){return}var H=o(this._o.field)?this._o.field:this._o.trigger,F=this._o.trigger,A=this.el.offsetWidth,I=this.el.offsetHeight,E=window.innerWidth||n.documentElement.clientWidth,D=window.innerHeight||n.documentElement.clientHeight,B=window.pageYOffset||n.body.scrollTop||n.documentElement.scrollTop,C,G,z;if(typeof H.getBoundingClientRect==="function"){z=H.getBoundingClientRect();C=z.left+window.pageXOffset;G=z.bottom+window.pageYOffset}else{C=F.offsetLeft;G=F.offsetTop+F.offsetHeight;while((F=F.offsetParent)){C+=F.offsetLeft;G+=F.offsetTop}}if((this._o.reposition&&C+A>E)||(this._o.position.indexOf("right")>-1&&C-A+H.offsetWidth>0)){C=C-A+H.offsetWidth}if((this._o.reposition&&G+I>D+B)||(this._o.position.indexOf("top")>-1&&G-I-H.offsetHeight>0)){G=G-I-H.offsetHeight}this.el.style.cssText=["position: absolute","left: "+C+"px","top: "+G+"px"].join(";")},render:function(H){var z=this._o,D=new Date(),F=[],J=[],G;j(D);G=new Date(D.getTime());for(var E=0,A=0;E<12;E++){G.setFullYear(H,E);var C=x(this._d)?q(G,this._d):false,B=q(G,D),I=(z.minDate&&G<z.minDate)||(z.maxDate&&G>z.maxDate)||(z.disableMonthFn&&z.disableMonthFn(G));J.push(m(z,E,H,C,B,I));if(++A===3){F.push(e(J,z.isRTL));J=[];A=0}}return l(z,F)},isVisible:function(){return this._v},show:function(){if(!this._v){k(this.el,"is-hidden");this._v=true;this.draw();if(this._o.bound){p(n,"click",this._onClick);this.adjustPosition()}if(typeof this._o.onOpen==="function"){this._o.onOpen.call(this)}}},hide:function(){var z=this._v;if(z!==false){if(this._o.bound){t(n,"click",this._onClick)}this.el.style.cssText="";i(this.el,"is-hidden");this._v=false;if(z!==undefined&&z!==false&&typeof this._o.onClose==="function"){this._o.onClose.call(this)}}},destroy:function(){this.hide();t(this.el,"mousedown",this._onMouseDown,true);t(this.el,"change",this._onChange);if(this._o.field){t(this._o.field,"change",this._onInputChange);if(this._o.bound){t(this._o.trigger,"click",this._onInputClick);t(this._o.trigger,"focus",this._onInputFocus);t(this._o.trigger,"blur",this._onInputBlur)}}if(this.el.parentNode){this.el.parentNode.removeChild(this.el)}}};return Pikamonth}));